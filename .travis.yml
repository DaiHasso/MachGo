language: go

branches:
  only:
    - master
    - develop

before_install:
  - go get github.com/onsi/gomega
  - go get github.com/onsi/ginkgo/ginkgo
  - go get github.com/modocache/gover
  - go get github.com/mattn/goveralls
  - go get -u gopkg.in/alecthomas/gometalinter.v2
  - alias gometalinter="gometalinter.v2"

install:
  # Add Godeps dependencies to GOPATH and PATH
  - export GOPATH="${TRAVIS_BUILD_DIR}/Godeps/_workspace:$GOPATH"
  - export PATH="${TRAVIS_BUILD_DIR}/Godeps/_workspace/bin:$PATH"

before_script:
  - gometalinter --disable-all --enable=errcheck --enable=vet --enable=vetshadow --enable=gosec ./...

script:
  - ginkgo -r --failOnPending --cover --trace ./...

after_success:
  - gover
  - goveralls -coverprofile=gover.coverprofile -service travis-ci -repotoken $COVERALLS_TOKEN
